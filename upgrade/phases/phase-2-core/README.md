# Phase 2: Core Educational Features
## ÙØ§Ø² 2: ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ (Agent Core)

**Ù…Ø¯Øª Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ**: 3 Ù‡ÙØªÙ‡  
**Agent Ù…Ø³Ø¦ÙˆÙ„**: Core Agent  
**ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ**: Phase 1 Base Ø¨Ø§ÛŒØ¯ Ú©Ø§Ù…Ù„ Ø¨Ø§Ø´Ø¯

## Ø§Ù‡Ø¯Ø§Ù ÙØ§Ø²

### Ù‡Ø¯Ù Ø§ØµÙ„ÛŒ
Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ú©Ù‡ Ú†Øªâ€ŒØ¨Ø§Øª Ø±Ø§ Ø¨Ù‡ ÛŒÚ© Ø¯Ø³ØªÛŒØ§Ø± ÙˆØ§Ù‚Ø¹ÛŒ ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯

### Ø§Ù‡Ø¯Ø§Ù ÙØ±Ø¹ÛŒ
1. Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´Ù…Ù†Ø¯ ØªÙˆÙ„ÛŒØ¯ ØªÚ©Ø§Ù„ÛŒÙ
2. Ø¨Ø§Ù†Ú© Ø³ÙˆØ§Ù„ Ø¬Ø§Ù…Ø¹ Ø¨Ø§ AI
3. Ø³ÛŒØ³ØªÙ… Ú¯ÛŒÙ…ÛŒÙÛŒÚ©ÛŒØ´Ù† Ú©Ø§Ù…Ù„
4. ÛŒØ§Ø¯Ø¢ÙˆØ±Ù‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯
5. ØªØ­Ù„ÛŒÙ„ Ø¹Ù…Ù„Ú©Ø±Ø¯ ØªØ­ØµÛŒÙ„ÛŒ

## ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯

### 1. AI Homework Assistant ğŸ¤–
- **ØªÙˆÙ„ÛŒØ¯ ØªÚ©Ù„ÛŒÙ Ù‡ÙˆØ´Ù…Ù†Ø¯**: Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù
- **Ø­Ù„ Ú¯Ø§Ù… Ø¨Ù‡ Ú¯Ø§Ù…**: ØªÙˆØ¶ÛŒØ­ Ù…Ø±Ø­Ù„Ù‡â€ŒØ§ÛŒ Ù…Ø³Ø§Ø¦Ù„
- **ØªØµØ­ÛŒØ­ Ø®ÙˆØ¯Ú©Ø§Ø±**: Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§
- **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…Ù†Ø§Ø¨Ø¹**: Ú©ØªØ§Ø¨ Ùˆ ÙˆÛŒØ¯ÛŒÙˆ Ù…Ù†Ø§Ø³Ø¨

### 2. Question Bank System ğŸ“š
- **Ø¨Ø§Ù†Ú© Ø³ÙˆØ§Ù„ Ø¬Ø§Ù…Ø¹**: 10,000+ Ø³ÙˆØ§Ù„
- **Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯**: Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…ÙˆØ¶ÙˆØ¹ Ùˆ Ø³Ø®ØªÛŒ
- **ØªÙˆÙ„ÛŒØ¯ Ø®ÙˆØ¯Ú©Ø§Ø±**: AI Ø¨Ø±Ø§ÛŒ Ø³ÙˆØ§Ù„Ø§Øª Ø¬Ø¯ÛŒØ¯
- **Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯**: Ø¢Ù…Ø§Ø± Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§

### 3. Advanced Gamification ğŸ®
- **Ø³ÛŒØ³ØªÙ… Ù…Ø¯Ø§Ù„**: 50+ Ù†ÙˆØ¹ Ø¯Ø³ØªØ§ÙˆØ±Ø¯
- **Ù„ÛŒØ¯Ø±Ø¨ÙˆØ±Ø¯**: Ø±Ù‚Ø§Ø¨Øª Ø³Ø§Ù„Ù…
- **Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡**: Ø§Ù†Ú¯ÛŒØ²Ù‡ Ù…Ø¯Ø§ÙˆÙ…
- **Ø¢ÙˆØ§ØªØ§Ø± Ùˆ Ø´Ø®ØµÛŒâ€ŒØ³Ø§Ø²ÛŒ**: Ù‡ÙˆÛŒØª Ø¨ØµØ±ÛŒ

### 4. Smart Reminders â°
- **ÛŒØ§Ø¯Ø¢ÙˆØ± Ù‡ÙˆØ´Ù…Ù†Ø¯**: Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù„Ú¯ÙˆÛŒ Ù…Ø·Ø§Ù„Ø¹Ù‡
- **Ø§Ø¹Ù„Ø§Ù†Ø§Øª ØªØ·Ø¨ÛŒÙ‚ÛŒ**: Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡
- **Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù…ÙˆØ¹Ø¯**: Ù‡Ø´Ø¯Ø§Ø± Ø²ÙˆØ¯Ù‡Ù†Ú¯Ø§Ù…
- **Ø§Ù†Ú¯ÛŒØ²Ø´ÛŒ**: Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ø«Ø¨Øª

## ØªØ­ÙˆÛŒÙ„â€ŒÙ‡Ø§ (Deliverables)

### 1. Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
- [ ] Question model Ø¨Ø§ AI integration
- [ ] Achievement Ùˆ Badge system
- [ ] Reminder Ùˆ Notification
- [ ] StudySession tracking
- [ ] QuizResult Ùˆ Performance

### 2. AI Services
- [ ] Homework Generator Service
- [ ] Step-by-step Solver
- [ ] Content Recommender
- [ ] Performance Analyzer

### 3. Gamification System
- [ ] Points Ùˆ Levels
- [ ] Badges Ùˆ Achievements
- [ ] Leaderboard
- [ ] Daily Challenges

### 4. Notification System
- [ ] Smart Reminders
- [ ] Push Notifications
- [ ] Email Reports
- [ ] SMS Alerts

## Implementation Details

### AI Homework Assistant
```python
# educational/ai_services.py
class HomeworkAI:
    def generate_homework(self, subject, grade_level, difficulty, topic=None):
        """ØªÙˆÙ„ÛŒØ¯ ØªÚ©Ù„ÛŒÙ Ù‡ÙˆØ´Ù…Ù†Ø¯"""
        prompt = f"""
        ØªÙˆÙ„ÛŒØ¯ ØªÚ©Ù„ÛŒÙ {subject.persian_name} Ø¨Ø±Ø§ÛŒ Ù¾Ø§ÛŒÙ‡ {grade_level}
        Ø³Ø·Ø­ Ø³Ø®ØªÛŒ: {difficulty}/5
        {f'Ù…ÙˆØ¶ÙˆØ¹: {topic}' if topic else ''}
        
        Ø®Ø±ÙˆØ¬ÛŒ Ø¨Ù‡ ÙØ±Ù…Øª JSON:
        {{
            "title": "Ø¹Ù†ÙˆØ§Ù† ØªÚ©Ù„ÛŒÙ",
            "description": "Ø´Ø±Ø­ Ú©Ø§Ù…Ù„",
            "questions": [
                {{"question": "Ø³ÙˆØ§Ù„ 1", "answer": "Ù¾Ø§Ø³Ø®", "explanation": "ØªÙˆØ¶ÛŒØ­"}},
                ...
            ],
            "estimated_minutes": 30,
            "learning_objectives": ["Ù‡Ø¯Ù 1", "Ù‡Ø¯Ù 2"]
        }}
        """
        
        response = self.openai_client.chat.completions.create(
            model="gpt-4",
            messages=[{"role": "user", "content": prompt}],
            temperature=0.7
        )
        
        return json.loads(response.choices[0].message.content)
    
    def solve_step_by_step(self, question, grade_level):
        """Ø­Ù„ Ú¯Ø§Ù… Ø¨Ù‡ Ú¯Ø§Ù… Ù…Ø³Ø§Ø¦Ù„"""
        prompt = f"""
        Ø³ÙˆØ§Ù„ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ù¾Ø§ÛŒÙ‡ {grade_level}:
        {question}
        
        Ù„Ø·ÙØ§Ù‹ Ø­Ù„ Ú¯Ø§Ù… Ø¨Ù‡ Ú¯Ø§Ù… Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯:
        1. Ø¯Ø±Ú© Ù…Ø³Ø¦Ù„Ù‡
        2. Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
        3. Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ´ Ø­Ù„
        4. Ù…Ø­Ø§Ø³Ø¨Ù‡
        5. Ø¨Ø±Ø±Ø³ÛŒ Ø¬ÙˆØ§Ø¨
        
        Ø²Ø¨Ø§Ù†: ÙØ§Ø±Ø³ÛŒ Ø³Ø§Ø¯Ù‡ Ùˆ Ú©ÙˆØ¯Ú©Ø§Ù†Ù‡
        """
        
        response = self.openai_client.chat.completions.create(
            model="gpt-4",
            messages=[{"role": "user", "content": prompt}],
            temperature=0.3
        )
        
        return response.choices[0].message.content
```

### Question Bank System
```python
# educational/models.py (Ø§Ø¶Ø§ÙÙ‡ Ø¨Ù‡ ÙØ§Ø² 1)
class Question(models.Model):
    """Ø¨Ø§Ù†Ú© Ø³ÙˆØ§Ù„Ø§Øª"""
    QUESTION_TYPES = [
        ('multiple_choice', 'Ú†Ù†Ø¯Ú¯Ø²ÛŒÙ†Ù‡â€ŒØ§ÛŒ'),
        ('true_false', 'Ø¯Ø±Ø³Øª/ØºÙ„Ø·'),
        ('short_answer', 'Ù¾Ø§Ø³Ø® Ú©ÙˆØªØ§Ù‡'),
        ('essay', 'ØªØ´Ø±ÛŒØ­ÛŒ'),
        ('math_problem', 'Ù…Ø³Ø¦Ù„Ù‡ Ø±ÛŒØ§Ø¶ÛŒ'),
        ('fill_blank', 'Ø¬Ø§ÛŒ Ø®Ø§Ù„ÛŒ'),
    ]
    
    subject = models.ForeignKey(Subject, on_delete=models.CASCADE)
    grade_level = models.PositiveSmallIntegerField()
    
    # Ù…Ø­ØªÙˆØ§ÛŒ Ø³ÙˆØ§Ù„
    question_text = models.TextField(verbose_name='Ù…ØªÙ† Ø³ÙˆØ§Ù„')
    question_type = models.CharField(max_length=20, choices=QUESTION_TYPES)
    difficulty = models.PositiveSmallIntegerField(
        validators=[MinValueValidator(1), MaxValueValidator(5)]
    )
    
    # Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§
    correct_answer = models.TextField(verbose_name='Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­')
    explanation = models.TextField(verbose_name='ØªÙˆØ¶ÛŒØ­')
    options = models.JSONField(default=dict, blank=True)  # Ø¨Ø±Ø§ÛŒ Ú†Ù†Ø¯Ú¯Ø²ÛŒÙ†Ù‡â€ŒØ§ÛŒ
    
    # Ù…ØªØ§Ø¯ÛŒØªØ§
    tags = models.JSONField(default=list)  # Ù…ÙˆØ¶ÙˆØ¹Ø§Øª
    source = models.CharField(max_length=100, blank=True)  # Ù…Ù†Ø¨Ø¹ Ø³ÙˆØ§Ù„
    created_by = models.CharField(max_length=20, default='AI')
    is_verified = models.BooleanField(default=False)
    usage_count = models.PositiveIntegerField(default=0)
    success_rate = models.FloatField(default=0.0)  # Ø¯Ø±ØµØ¯ Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­
    
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        verbose_name = 'Ø³ÙˆØ§Ù„'
        verbose_name_plural = 'Ø³ÙˆØ§Ù„Ø§Øª'
        indexes = [
            models.Index(fields=['subject', 'grade_level', 'difficulty']),
            models.Index(fields=['tags']),
        ]
    
    def __str__(self):
        return f"{self.question_text[:50]}..."

class QuizSession(models.Model):
    """Ø¬Ù„Ø³Ù‡ Ø¢Ø²Ù…ÙˆÙ†/ØªÙ…Ø±ÛŒÙ†"""
    student = models.ForeignKey(StudentProfile, on_delete=models.CASCADE)
    subject = models.ForeignKey(Subject, on_delete=models.CASCADE)
    
    title = models.CharField(max_length=200)
    questions = models.ManyToManyField(Question, through='QuizResult')
    
    started_at = models.DateTimeField(auto_now_add=True)
    completed_at = models.DateTimeField(null=True, blank=True)
    time_limit_minutes = models.PositiveIntegerField(default=30)
    
    total_score = models.FloatField(default=0.0)
    is_completed = models.BooleanField(default=False)
    
    class Meta:
        verbose_name = 'Ø¬Ù„Ø³Ù‡ Ø¢Ø²Ù…ÙˆÙ†'
        verbose_name_plural = 'Ø¬Ù„Ø³Ø§Øª Ø¢Ø²Ù…ÙˆÙ†'

class QuizResult(models.Model):
    """Ù†ØªÛŒØ¬Ù‡ Ù¾Ø§Ø³Ø® Ø¨Ù‡ Ø³ÙˆØ§Ù„"""
    quiz_session = models.ForeignKey(QuizSession, on_delete=models.CASCADE)
    question = models.ForeignKey(Question, on_delete=models.CASCADE)
    
    student_answer = models.TextField()
    is_correct = models.BooleanField()
    points_earned = models.FloatField(default=0.0)
    time_spent_seconds = models.PositiveIntegerField()
    
    answered_at = models.DateTimeField(auto_now_add=True)
```

### Gamification System
```python
# educational/models.py (Ø§Ø¯Ø§Ù…Ù‡)
class Achievement(models.Model):
    """Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ Ùˆ Ù…Ø¯Ø§Ù„â€ŒÙ‡Ø§"""
    CATEGORIES = [
        ('homework', 'ØªÚ©Ø§Ù„ÛŒÙ'),
        ('study_time', 'Ø²Ù…Ø§Ù† Ù…Ø·Ø§Ù„Ø¹Ù‡'),
        ('streak', 'ØªØ¯Ø§ÙˆÙ…'),
        ('subject_mastery', 'ØªØ³Ù„Ø· Ø¨Ø± Ø¯Ø±Ø³'),
        ('quiz_performance', 'Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¢Ø²Ù…ÙˆÙ†'),
        ('special', 'ÙˆÛŒÚ˜Ù‡'),
    ]
    
    name = models.CharField(max_length=100, unique=True)
    persian_name = models.CharField(max_length=100)
    description = models.TextField()
    category = models.CharField(max_length=20, choices=CATEGORIES)
    
    # Ø´Ø±Ø§ÛŒØ· Ø¯Ø±ÛŒØ§ÙØª
    condition = models.JSONField(help_text="Ø´Ø±Ø§ÛŒØ· JSON Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù…Ø¯Ø§Ù„")
    points_reward = models.PositiveIntegerField(default=50)
    
    # Ù†Ù…Ø§ÛŒØ´
    icon = models.CharField(max_length=50, default='trophy')
    color = models.CharField(max_length=7, default='#ffd700')
    rarity = models.CharField(max_length=20, default='common')  # common/rare/epic/legendary
    
    is_active = models.BooleanField(default=True)
    created_at = models.DateTimeField(auto_now_add=True)
    
    def check_condition(self, student_profile):
        """Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø±Ø§ÛŒØ· Ø¯Ø±ÛŒØ§ÙØª Ù…Ø¯Ø§Ù„"""
        # Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…Ù†Ø·Ù‚ Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø±Ø§ÛŒØ·
        pass

class StudentAchievement(models.Model):
    """Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ú©Ø³Ø¨ Ø´Ø¯Ù‡ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²"""
    student = models.ForeignKey(StudentProfile, on_delete=models.CASCADE)
    achievement = models.ForeignKey(Achievement, on_delete=models.CASCADE)
    
    earned_at = models.DateTimeField(auto_now_add=True)
    progress_data = models.JSONField(default=dict)  # Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØª
    
    class Meta:
        unique_together = ['student', 'achievement']
        verbose_name = 'Ø¯Ø³ØªØ§ÙˆØ±Ø¯ Ú©Ø³Ø¨ Ø´Ø¯Ù‡'
        verbose_name_plural = 'Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ú©Ø³Ø¨ Ø´Ø¯Ù‡'

class DailyChallenge(models.Model):
    """Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡"""
    date = models.DateField(unique=True)
    title = models.CharField(max_length=200)
    description = models.TextField()
    
    # Ø´Ø±Ø§ÛŒØ· Ú†Ø§Ù„Ø´
    challenge_type = models.CharField(max_length=20)  # homework_count/study_time/quiz_score
    target_value = models.PositiveIntegerField()
    subject = models.ForeignKey(Subject, on_delete=models.CASCADE, null=True, blank=True)
    grade_levels = models.JSONField(default=list)
    
    # Ù¾Ø§Ø¯Ø§Ø´
    points_reward = models.PositiveIntegerField(default=100)
    badge_reward = models.ForeignKey(Achievement, on_delete=models.SET_NULL, null=True, blank=True)
    
    is_active = models.BooleanField(default=True)
    
    class Meta:
        verbose_name = 'Ú†Ø§Ù„Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡'
        verbose_name_plural = 'Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡'

class ChallengeParticipation(models.Model):
    """Ø´Ø±Ú©Øª Ø¯Ø± Ú†Ø§Ù„Ø´"""
    student = models.ForeignKey(StudentProfile, on_delete=models.CASCADE)
    challenge = models.ForeignKey(DailyChallenge, on_delete=models.CASCADE)
    
    progress = models.PositiveIntegerField(default=0)
    is_completed = models.BooleanField(default=False)
    completed_at = models.DateTimeField(null=True, blank=True)
    
    class Meta:
        unique_together = ['student', 'challenge']
```

### Smart Reminders
```python
# educational/reminder_service.py
from celery import shared_task
from django.utils import timezone
from datetime import timedelta
from .models import StudentProfile, Homework, DailyActivity

class SmartReminderService:
    """Ø³Ø±ÙˆÛŒØ³ ÛŒØ§Ø¯Ø¢ÙˆØ±Ù‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯"""
    
    @staticmethod
    def get_optimal_reminder_time(student_profile):
        """Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¨Ù‡ØªØ±ÛŒÙ† Ø²Ù…Ø§Ù† ÛŒØ§Ø¯Ø¢ÙˆØ±ÛŒ"""
        # ØªØ­Ù„ÛŒÙ„ Ø§Ù„Ú¯ÙˆÛŒ Ù…Ø·Ø§Ù„Ø¹Ù‡ Ú¯Ø°Ø´ØªÙ‡
        recent_activities = DailyActivity.objects.filter(
            student=student_profile,
            date__gte=timezone.now().date() - timedelta(days=7)
        )
        
        # ÛŒØ§ÙØªÙ† Ø³Ø§Ø¹Øª ÙØ¹Ø§Ù„ÛŒØª Ø¨ÛŒØ´ØªØ±
        peak_hours = []
        for activity in recent_activities:
            if activity.peak_activity_hour:
                peak_hours.append(activity.peak_activity_hour)
        
        if peak_hours:
            optimal_hour = max(set(peak_hours), key=peak_hours.count)
        else:
            optimal_hour = 16  # 4 Ø¹ØµØ± Ù¾ÛŒØ´â€ŒÙØ±Ø¶
        
        return optimal_hour
    
    @shared_task
    def send_homework_reminders():
        """Ø§Ø±Ø³Ø§Ù„ ÛŒØ§Ø¯Ø¢ÙˆØ± ØªÚ©Ø§Ù„ÛŒÙ"""
        tomorrow = timezone.now().date() + timedelta(days=1)
        
        # ØªÚ©Ø§Ù„ÛŒÙ ÙØ±Ø¯Ø§
        upcoming_homeworks = Homework.objects.filter(
            due_date__date=tomorrow,
            status__in=['pending', 'in_progress']
        ).select_related('student', 'subject')
        
        for homework in upcoming_homeworks:
            student = homework.student
            
            # Ø¨Ø±Ø±Ø³ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø¹Ù„Ø§Ù†
            if not student.notification_homework:
                continue
            
            # Ø§Ø±Ø³Ø§Ù„ Ø§Ø¹Ù„Ø§Ù†
            message = f"""
            ğŸ”” ÛŒØ§Ø¯Ø¢ÙˆØ± ØªÚ©Ù„ÛŒÙ
            
            Ø¯Ø±Ø³: {homework.subject.persian_name}
            Ø¹Ù†ÙˆØ§Ù†: {homework.title}
            Ù…ÙˆØ¹Ø¯: ÙØ±Ø¯Ø§
            Ø²Ù…Ø§Ù† ØªØ®Ù…ÛŒÙ†ÛŒ: {homework.estimated_minutes} Ø¯Ù‚ÛŒÙ‚Ù‡
            
            Ø¨ÛŒØ§ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ…! ğŸ’ª
            """
            
            # Ø§Ø±Ø³Ø§Ù„ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
            NotificationService.send_push(student.user, message)
            
            # SMS Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ§Ø±Ø¯ Ù…Ù‡Ù…
            if homework.priority >= 4:
                NotificationService.send_sms(student.user.phone_number, message)
    
    @shared_task
    def send_daily_motivation():
        """Ø§Ø±Ø³Ø§Ù„ Ø§Ù†Ú¯ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡"""
        active_students = StudentProfile.objects.filter(
            last_activity_date__gte=timezone.now().date() - timedelta(days=3),
            notification_daily_reminder=True
        )
        
        for student in active_students:
            optimal_time = SmartReminderService.get_optimal_reminder_time(student)
            current_hour = timezone.now().hour
            
            # Ø§Ø±Ø³Ø§Ù„ Ø¯Ø± Ø²Ù…Ø§Ù† Ø¨Ù‡ÛŒÙ†Ù‡
            if current_hour == optimal_time:
                motivation_message = MotivationGenerator.get_daily_message(student)
                NotificationService.send_push(student.user, motivation_message)

class MotivationGenerator:
    """ØªÙˆÙ„ÛŒØ¯ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ú¯ÛŒØ²Ø´ÛŒ"""
    
    MESSAGES = {
        'streak': [
            "ğŸ”¥ {streak} Ø±ÙˆØ² Ù…ØªÙˆØ§Ù„ÛŒ! Ø±Ú©ÙˆØ±Ø¯Øª ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡ Ø§Ø³Øª!",
            "ğŸ’ª {streak} Ø±ÙˆØ² Ù¾Ø´Øª Ø³Ø± Ù‡Ù…! Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ø¯Ù‡ Ù‚Ù‡Ø±Ù…Ø§Ù†!",
            "â­ {streak} Ø±ÙˆØ² Ø¨Ø¯ÙˆÙ† ÙˆÙ‚ÙÙ‡! ØªÙˆ ÙˆØ§Ù‚Ø¹Ø§Ù‹ Ø¹Ø§Ù„ÛŒ Ù‡Ø³ØªÛŒ!"
        ],
        'homework': [
            "ğŸ“š {count} ØªÚ©Ù„ÛŒÙ Ø§Ù…Ø±ÙˆØ² Ø¯Ø§Ø±ÛŒ. Ø¨ÛŒØ§ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ…!",
            "âœï¸ ÙˆÙ‚Øª Ø§Ù†Ø¬Ø§Ù… ØªÚ©Ø§Ù„ÛŒÙ! {count} ØªØ§ Ù…Ù†ØªØ¸Ø±Øª Ù‡Ø³ØªÙ†Ø¯.",
            "ğŸ¯ {count} ØªÚ©Ù„ÛŒÙØŒ {count} ÙØ±ØµØª Ø¨Ø±Ø§ÛŒ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ!"
        ],
        'level_up': [
            "ğŸ‰ ØªØ¨Ø±ÛŒÚ©! Ø¨Ù‡ Ø³Ø·Ø­ {level} Ø±Ø³ÛŒØ¯ÛŒ!",
            "ğŸš€ Ø³Ø·Ø­ Ø¬Ø¯ÛŒØ¯! Ø­Ø§Ù„Ø§ Ø³Ø·Ø­ {level} Ù‡Ø³ØªÛŒ!",
            "ğŸ‘‘ Ø§Ø±ØªÙ‚Ø§ ÛŒØ§ÙØªÛŒ! Ø³Ø·Ø­ {level} Ù…Ù†ØªØ¸Ø±Øª Ø¨ÙˆØ¯!"
        ]
    }
    
    @classmethod
    def get_daily_message(cls, student_profile):
        """ØªÙˆÙ„ÛŒØ¯ Ù¾ÛŒØ§Ù… Ø±ÙˆØ²Ø§Ù†Ù‡"""
        import random
        
        # Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ Ù¾ÛŒØ§Ù… Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆØ¶Ø¹ÛŒØª
        if student_profile.study_streak >= 3:
            messages = cls.MESSAGES['streak']
            return random.choice(messages).format(streak=student_profile.study_streak)
        
        # Ø¨Ø±Ø±Ø³ÛŒ ØªÚ©Ø§Ù„ÛŒÙ Ø§Ù…Ø±ÙˆØ²
        today_homeworks = student_profile.homeworks.filter(
            due_date__date=timezone.now().date(),
            status__in=['pending', 'in_progress']
        ).count()
        
        if today_homeworks > 0:
            messages = cls.MESSAGES['homework']
            return random.choice(messages).format(count=today_homeworks)
        
        # Ù¾ÛŒØ§Ù… Ø¹Ù…ÙˆÙ…ÛŒ
        general_messages = [
            "ğŸŒŸ Ø§Ù…Ø±ÙˆØ² Ø±ÙˆØ² Ø®ÙˆØ¨ÛŒ Ø¨Ø±Ø§ÛŒ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ø§Ø³Øª!",
            "ğŸ“– Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ø´Ù Ú†ÛŒØ²Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ØŸ",
            "ğŸ’¡ Ù‡Ø± Ø±ÙˆØ² Ù‚Ø¯Ù…ÛŒ Ø¨Ù‡ Ø¬Ù„Ùˆ! Ø¨ÛŒØ§ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ…!"
        ]
        
        return random.choice(general_messages)
```

### Performance Analytics
```python
# educational/analytics.py
class PerformanceAnalyzer:
    """ØªØ­Ù„ÛŒÙ„â€ŒÚ¯Ø± Ø¹Ù…Ù„Ú©Ø±Ø¯ ØªØ­ØµÛŒÙ„ÛŒ"""
    
    def __init__(self, student_profile):
        self.student = student_profile
    
    def get_subject_performance(self, days=30):
        """ØªØ­Ù„ÛŒÙ„ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¯Ø± Ù‡Ø± Ø¯Ø±Ø³"""
        cutoff_date = timezone.now().date() - timedelta(days=days)
        
        homeworks = self.student.homeworks.filter(
            assigned_date__date__gte=cutoff_date,
            status='completed'
        ).select_related('subject')
        
        subject_stats = {}
        for homework in homeworks:
            subject_name = homework.subject.persian_name
            
            if subject_name not in subject_stats:
                subject_stats[subject_name] = {
                    'total_homeworks': 0,
                    'total_score': 0,
                    'total_time': 0,
                    'difficulties': []
                }
            
            stats = subject_stats[subject_name]
            stats['total_homeworks'] += 1
            if homework.score:
                stats['total_score'] += homework.score
            stats['total_time'] += homework.estimated_minutes
            stats['difficulties'].append(homework.difficulty)
        
        # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†â€ŒÙ‡Ø§
        for subject, stats in subject_stats.items():
            if stats['total_homeworks'] > 0:
                stats['average_score'] = stats['total_score'] / stats['total_homeworks']
                stats['average_difficulty'] = sum(stats['difficulties']) / len(stats['difficulties'])
            else:
                stats['average_score'] = 0
                stats['average_difficulty'] = 0
        
        return subject_stats
    
    def identify_weak_areas(self):
        """Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù"""
        performance = self.get_subject_performance()
        
        weak_subjects = []
        for subject, stats in performance.items():
            if stats['average_score'] < 70:  # Ú©Ù…ØªØ± Ø§Ø² 70
                weak_subjects.append({
                    'subject': subject,
                    'average_score': stats['average_score'],
                    'recommendation': self._get_improvement_recommendation(subject, stats)
                })
        
        return sorted(weak_subjects, key=lambda x: x['average_score'])
    
    def _get_improvement_recommendation(self, subject, stats):
        """Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ø¨Ù‡Ø¨ÙˆØ¯"""
        if stats['average_score'] < 50:
            return f"Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ…Ø±ÛŒÙ† Ø¨ÛŒØ´ØªØ± Ø¯Ø± {subject}. Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: ØªÙ…Ø±ÛŒÙ† Ø±ÙˆØ²Ø§Ù†Ù‡ 15 Ø¯Ù‚ÛŒÙ‚Ù‡"
        elif stats['average_score'] < 70:
            return f"Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„ Ø¯Ø± {subject}. Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: Ù…Ø±ÙˆØ± Ù…Ø¨Ø§Ø­Ø« Ø¶Ø¹ÛŒÙ"
        else:
            return f"Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø®ÙˆØ¨ Ø¯Ø± {subject}. Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ø¯Ù‡!"
    
    def generate_study_plan(self, days=7):
        """ØªÙˆÙ„ÛŒØ¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø·Ø§Ù„Ø¹Ù‡"""
        weak_areas = self.identify_weak_areas()
        daily_goal = self.student.daily_study_goal
        
        plan = {}
        for i in range(days):
            date = timezone.now().date() + timedelta(days=i)
            
            # ØªÙ‚Ø³ÛŒÙ… Ø²Ù…Ø§Ù† Ø¨ÛŒÙ† Ø¯Ø±ÙˆØ³ Ø¶Ø¹ÛŒÙ
            if weak_areas:
                time_per_subject = daily_goal // len(weak_areas)
                daily_plan = []
                
                for weak_area in weak_areas:
                    daily_plan.append({
                        'subject': weak_area['subject'],
                        'minutes': time_per_subject,
                        'focus': 'ØªÙ‚ÙˆÛŒØª Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù'
                    })
                
                plan[date.isoformat()] = daily_plan
            else:
                # Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…ØªØ¹Ø§Ø¯Ù„
                plan[date.isoformat()] = [{
                    'subject': 'Ù…Ø±ÙˆØ± Ú©Ù„ÛŒ',
                    'minutes': daily_goal,
                    'focus': 'Ø­ÙØ¸ Ø³Ø·Ø­ ÙØ¹Ù„ÛŒ'
                }]
        
        return plan
```

### API Views Ø¨Ø±Ø§ÛŒ ÙØ§Ø² 2
```python
# educational/views.py (Ø§Ø¯Ø§Ù…Ù‡ ÙØ§Ø² 1)

class QuestionViewSet(viewsets.ReadOnlyModelViewSet):
    """API Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ù†Ú© Ø³ÙˆØ§Ù„Ø§Øª"""
    permission_classes = [permissions.IsAuthenticated]
    
    def get_queryset(self):
        if hasattr(self.request.user, 'student_profile'):
            grade = self.request.user.student_profile.grade_level
            return Question.objects.filter(
                grade_level=grade,
                is_verified=True
            ).select_related('subject')
        return Question.objects.none()
    
    @action(detail=False, methods=['post'])
    def generate_quiz(self, request):
        """ØªÙˆÙ„ÛŒØ¯ Ø¢Ø²Ù…ÙˆÙ†"""
        subject_id = request.data.get('subject_id')
        difficulty = request.data.get('difficulty', 2)
        question_count = request.data.get('count', 10)
        
        questions = self.get_queryset().filter(
            subject_id=subject_id,
            difficulty=difficulty
        ).order_by('?')[:question_count]  # Ø§Ù†ØªØ®Ø§Ø¨ ØªØµØ§Ø¯ÙÛŒ
        
        # Ø§ÛŒØ¬Ø§Ø¯ Ø¬Ù„Ø³Ù‡ Ø¢Ø²Ù…ÙˆÙ†
        quiz_session = QuizSession.objects.create(
            student=request.user.student_profile,
            subject_id=subject_id,
            title=f"Ø¢Ø²Ù…ÙˆÙ† {questions.first().subject.persian_name}"
        )
        
        quiz_session.questions.set(questions)
        
        return Response({
            'quiz_session_id': quiz_session.id,
            'questions': QuestionSerializer(questions, many=True).data
        })

class AchievementViewSet(viewsets.ReadOnlyModelViewSet):
    """API Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§"""
    permission_classes = [permissions.IsAuthenticated]
    
    def get_queryset(self):
        return Achievement.objects.filter(is_active=True)
    
    @action(detail=False, methods=['get'])
    def my_achievements(self, request):
        """Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ú©Ø³Ø¨ Ø´Ø¯Ù‡ Ú©Ø§Ø±Ø¨Ø±"""
        if not hasattr(request.user, 'student_profile'):
            return Response({'achievements': []})
        
        earned = StudentAchievement.objects.filter(
            student=request.user.student_profile
        ).select_related('achievement')
        
        return Response({
            'earned_count': earned.count(),
            'achievements': [
                {
                    'achievement': AchievementSerializer(sa.achievement).data,
                    'earned_at': sa.earned_at,
                    'progress_data': sa.progress_data
                }
                for sa in earned
            ]
        })
    
    @action(detail=False, methods=['post'])
    def check_new_achievements(self, request):
        """Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯"""
        if not hasattr(request.user, 'student_profile'):
            return Response({'new_achievements': []})
        
        student = request.user.student_profile
        new_achievements = []
        
        # Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø±Ø§ÛŒØ· Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§
        for achievement in Achievement.objects.filter(is_active=True):
            if not StudentAchievement.objects.filter(
                student=student, 
                achievement=achievement
            ).exists():
                if self._check_achievement_condition(student, achievement):
                    # Ø§Ø¹Ø·Ø§ÛŒ Ø¯Ø³ØªØ§ÙˆØ±Ø¯
                    StudentAchievement.objects.create(
                        student=student,
                        achievement=achievement
                    )
                    
                    # Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ù…ØªÛŒØ§Ø²
                    student.add_points(achievement.points_reward, f"Ø¯Ø³ØªØ§ÙˆØ±Ø¯: {achievement.persian_name}")
                    
                    new_achievements.append(achievement)
        
        return Response({
            'new_achievements': AchievementSerializer(new_achievements, many=True).data,
            'message': f"{len(new_achievements)} Ø¯Ø³ØªØ§ÙˆØ±Ø¯ Ø¬Ø¯ÛŒØ¯ Ú©Ø³Ø¨ Ú©Ø±Ø¯ÛŒ!" if new_achievements else "ÙØ¹Ù„Ø§Ù‹ Ø¯Ø³ØªØ§ÙˆØ±Ø¯ Ø¬Ø¯ÛŒØ¯ÛŒ Ù†Ø¯Ø§Ø±ÛŒ"
        })
    
    def _check_achievement_condition(self, student, achievement):
        """Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø±Ø§ÛŒØ· Ø¯Ø³ØªØ§ÙˆØ±Ø¯"""
        condition = achievement.condition
        
        if achievement.category == 'homework':
            completed_count = student.homeworks.filter(status='completed').count()
            return completed_count >= condition.get('min_homeworks', 10)
        
        elif achievement.category == 'streak':
            return student.study_streak >= condition.get('min_days', 7)
        
        elif achievement.category == 'study_time':
            total_minutes = sum(
                a.study_minutes for a in student.daily_activities.all()
            )
            return total_minutes >= condition.get('min_minutes', 600)
        
        return False
```

## Testing Strategy ÙØ§Ø² 2

### Test Coverage Requirements
- [ ] Unit Tests: 85%+
- [ ] Integration Tests: Ú©Ù„ÛŒÙ‡ API endpoints
- [ ] Performance Tests: Ø²Ù…Ø§Ù† Ù¾Ø§Ø³Ø® < 2 Ø«Ø§Ù†ÛŒÙ‡
- [ ] Security Tests: Ø¯Ø³ØªØ±Ø³ÛŒ Ùˆ validation

### Sample Tests
```python
# educational/tests/test_ai_services.py
class AIHomeworkTest(TestCase):
    def test_homework_generation(self):
        """ØªØ³Øª ØªÙˆÙ„ÛŒØ¯ ØªÚ©Ù„ÛŒÙ Ø¨Ø§ AI"""
        ai_service = HomeworkAI()
        
        subject = Subject.objects.create(name='math', persian_name='Ø±ÛŒØ§Ø¶ÛŒ')
        result = ai_service.generate_homework(subject, 5, 2)
        
        self.assertIn('title', result)
        self.assertIn('questions', result)
        self.assertIsInstance(result['questions'], list)
        self.assertGreater(len(result['questions']), 0)

# educational/tests/test_gamification.py  
class GamificationTest(TestCase):
    def test_achievement_system(self):
        """ØªØ³Øª Ø³ÛŒØ³ØªÙ… Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§"""
        # ØªØ³Øª Ù…Ù†Ø·Ù‚ Ø§Ø¹Ø·Ø§ÛŒ Ù…Ø¯Ø§Ù„
        pass
```

## Deployment Notes

### Environment Variables
```bash
# .env Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯:
OPENAI_API_KEY=your_openai_key
EDUCATIONAL_MODE=true
AI_SAFETY_LEVEL=high
CONTENT_FILTER_ENABLED=true
GAMIFICATION_ENABLED=true
```

### Database Migrations
```bash
# Ø§Ø¬Ø±Ø§ÛŒ migrations Ø¬Ø¯ÛŒØ¯
python manage.py makemigrations educational
python manage.py migrate

# Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡
python manage.py setup_educational_data
python manage.py setup_achievements
python manage.py setup_question_bank
```

## Success Metrics

### Technical KPIs
- [ ] API Response Time < 2s
- [ ] AI Response Accuracy > 90%
- [ ] Question Bank > 5,000 items
- [ ] Achievement System 20+ badges

### User Experience KPIs  
- [ ] Homework Completion Rate > 75%
- [ ] Daily Active Users retention > 60%
- [ ] Average Session Time > 15 minutes
- [ ] User Satisfaction Score > 4.5/5

### Educational KPIs
- [ ] Grade Improvement > 10%
- [ ] Study Time Increase > 25%
- [ ] Parent Satisfaction > 80%
- [ ] Teacher Approval > 70%

---

**Ù†Ú©ØªÙ‡**: Ø§ÛŒÙ† ÙØ§Ø² Ø¨Ø± Ù¾Ø§ÛŒÙ‡ ÙØ§Ø² 1 Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.